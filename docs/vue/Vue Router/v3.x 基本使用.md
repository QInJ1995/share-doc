# 基本使用

## 介绍

Vue Router 是 Vue.js 的官方路由管理器，用于创建单页面应用程序的路由。

## 安装

::: code-group

```sh [npm]
npm install vue-router@3
```

```sh [pnpm]
pnpm add vue-router@3
```

```sh [yarn]
yarn add vue-router@3
```

:::

## 基本用法

### 创建 Vue 实例

```javascript
import Vue from 'vue';
import VueRouter from 'vue-router';

Vue.use(VueRouter);

// 定义组件
const Home = { template: '<div>Home</div>' };
const About = { template: '<div>About</div>' };

// 设置路由
const routes = [
  { path: '/', component: Home },
  { path: '/about', component: About }
];

// 创建路由实例
const router = new VueRouter({
  routes
});

// 创建 Vue 实例
new Vue({
  el: '#app',
  router,
  template: `
    <div id="app">
      <h1>导航</h1>
      <p>
        <router-link to="/">首页</router-link>
        <router-link to="/about">关于</router-link>
      </p>
      <router-view></router-view>
    </div>
  `
});
```

### HTML 模板

```html
<div id="app"></div>
```

## 路由模式

### History 模式

```javascript
const router = new VueRouter({
  mode: 'history',
  routes
});
```

::: tip
使用 history 模式需要服务器配置支持。
:::

### Hash 模式

```javascript
const router = new VueRouter({
  mode: 'hash', // 默认hash模式
  routes
});
```

## 动态路由匹配

```javascript
const User = {
  template: '<div>User {{ $route.params.id }}</div>'
};

const routes = [
  { path: '/user/:id', component: User }
];
```

## 嵌套路由

```javascript
const User = {
  template: `
    <div>
      <h2>User</h2>
      <router-view></router-view>
    </div>
  `
};

const UserProfile = { template: '<div>Profile</div>' };
const UserPosts = { template: '<div>Posts</div>' };

const routes = [
  {
    path: '/user/:id',
    component: User,
    children: [
      { path: 'profile', component: UserProfile },
      { path: 'posts', component: UserPosts }
    ]
  }
];
```

## 编程式导航

```javascript
// 字符串形式
this.$router.push('/about');

// 对象形式
this.$router.push({ path: '/about' });

// 带参数
this.$router.push({ name: 'user', params: { id: 123 } });
```

## 路由守卫

### 全局守卫

```javascript
router.beforeEach((to, from, next) => {
  // ...
  next();
});
```

### 路由独享守卫

```javascript
const routes = [
  {
    path: '/foo',
    component: Foo,
    beforeEnter: (to, from, next) => {
      // ...
      next();
    }
  }
];
```

### 组件内守卫

```javascript
const Foo = {
  template: '<div>Foo</div>',
  beforeRouteEnter(to, from, next) {
    // 在渲染该组件的对应路由被 confirm 前调用
    next();
  }
};
```

## 路由元信息

```javascript
const routes = [
  {
    path: '/foo',
    component: Foo,
    meta: { requiresAuth: true }
  }
];

// 使用路由元信息
router.beforeEach((to, from, next) => {
  if (to.matched.some(record => record.meta.requiresAuth)) {
    // 需要认证
  } else {
    next();
  }
});
```

## 路由懒加载

```javascript
const Foo = () => import('./Foo.vue');

const routes = [
  { path: '/foo', component: Foo }
];
```
